<!DOCTYPE html>
<html>
    <body style="background-color: gray">
        <div><b>Status:</b></div>
        <div style="position: absolute; top: 290px"><b>Info:</b></div>
        <div id="status" style="position: absolute; top: 8px; left: 60px"></div>
        <div id="items" style="position: absolute; top: 8px; left: 500px"></div>
        <div id="text" style="position: absolute; top: 300px"></div>
        <script type="text/javascript">
            var item_div = document.getElementById("items");
            item_div.innerHTML = "<b>Items:</b><br/>";
            var items = [" ", " ", " ", " ", " ", " ", " ", " "];
        </script>
        <script type="text/javascript">
            function update_items() {
                var result = "<b>Items:</b><br/>";
                for (var index = 0; index < items.length; index++) {
                    if (items[index] === " ") {
                        continue;
                    } else {
                        result += items[index] + "<br/>";
                    }
                }
                item_div.innerHTML = result;
            }
        </script>
        <script type="text/javascript">
            var div = document.getElementById("status");
            var text_div = document.getElementById("text");
            var below_div;
            function remove_info_text() {
                text_div.textContent = " ";
            }
            function set_below_div(function_name) {
                below_div = document.getElementById(function_name);
            }
        </script>
        <script type="text/javascript">
            function die(function_name) {
                div.textContent = "You are dead.";
                below_div.innerHTML = '<button onclick="wake()">Play again</button><br/><button onclick="function_name">Continue from last location</button>';
                text_div.innerHTML = 'You have died.';
            }
        </script>
        <div id="village"></div>
        <script type="text/javascript">
            set_below_div("village");
            var has_searched_room = false;
            var has_searched_kitchen = false;
            var has_fed_birds = false;
            var has_sword = false;
            wake();
            function wake() {
                div.textContent = "You are asleep.";
                below_div.innerHTML = '<button onclick="woken()">Wake up</button>';
            }
            function woken() {
                div.textContent = "Your head hurts, a bad dream perhaps.";
                below_div.innerHTML = '<button onclick="downstairs()">Go downstairs</button><br/><button onclick="search_bedroom_protection()">Search your room</button>';
            }
            function downstairs() {
                remove_info_text();
                if (!has_searched_kitchen) {
                    div.textContent = "You are slightly hungry.";
                } else {
                    div.textContent = "You want to go outside.";
                }
                below_div.innerHTML = '<button onclick="outside()">Go outside</button><br/><button onclick="search_kitchen()">Search the kitchen</button><br/><button onclick="search_bedroom()">Go to your room</button>';
            }
            function search_bedroom() {
                remove_info_text();
                if (!has_searched_room) {
                    div.textContent = "You feel drowsy.";
                } else {
                    div.textContent = "You have a longing to see your daughter.";
                }
                below_div.innerHTML = '<button onclick="downstairs()">Go downstairs</button><br/>';
                if (!has_searched_room) {
                    below_div.innerHTML += '<button onclick="search_bedroom_protection()">Search your room</button>';
                }
            }
            function search_bedroom_protection() {
                if (!has_searched_room) {
                    has_searched_room = !has_searched_room;
                    items[0] = "Coins: 5"
                    update_items();
                    below_div.innerHTML = '<button onclick="downstairs()">Go downstairs</button>';
                    text_div.innerHTML = 'You find some coins.';
                }
            }
            function outside() {
                remove_info_text();
                below_div.innerHTML = '<button onclick="clear_blacksmith()">Go to the blacksmith</button><br/><button onclick="downstairs()">Go to your house</button><br/><button onclick="feed_birds()">Feed the birds</button>';
                if (!has_sword) {
                    div.textContent = "You need to visit the blacksmith.";
                } else {
                    div.textContent = "You feel the spur of adventure in your step";
                    below_div += '<button onclick="forest(), remove_info_text()">Go to the forest</button>';
                }
                if (has_fed_birds) {
                    below_div.innerHTML = below_div.innerHTML.substring(0, below_div.innerHTML.length - 54);
                }
            }
            function search_kitchen() {
                if (!has_searched_kitchen) {
                    has_searched_kitchen = !has_searched_kitchen;
                    items[1] = "Seeds: 3";
                    update_items();
                    below_div.innerHTML = '<button onclick="outside()">Go outside</button><br/><button onclick="search_bedroom()">Go to your room</button>';
                    text_div.innerHTML = 'You find some seeds and an apple.<br/>You eat the apple.';
                    div.textContent = "You are no longer hungry.";
                } else {
                    below_div.innerHTML = '<button onclick="outside()">Go outside</button><br/><button onclick="search_bedroom()">Go to your room</button>';
                    text_div.innerHTML = 'You don\'t find anything.';
                }
            }
            function sword_blacksmith() {
                if (!has_sword) {
                    div.textContent = "You need a sword.";
                } else {
                    div.textContent = "You want to go outside.";
                }
                below_div.innerHTML = '<button onclick="outside(), remove_info_text()">Go outside</button><br/><br/><b>Shop:</b><br/><button onclick="buy_sword()">Buy a sword</button>';
                if (!has_fed_birds) {
                    below_div.innerHTML += ' 5 coins';
                } else {
                    below_div.innerHTML += ' 3 coins';
                    text_div.innerHTML = '<b>Blacksmith:</b> I saw you feed the birds, I always give discounts to kind folks.';
                }
            }
            function clear_blacksmith() {
                if (has_sword) {
                    below_div.innerHTML = '<button onclick="outside(), remove_info_text()">Go outside</button>';
                    text_div.innerHTML = '<b>Blacksmith:</b> I have nothing to sell you right now.';
                } else {
                    sword_blacksmith();
                }
            }
            function buy_sword() {
                if (items[0] === "Coins: 5") {
                    if (has_fed_birds) {
                        items[0] = "Coins: 2";
                    } else {
                        items[0] = " ";
                    }
                } else {
                    text_div.innerHTML = '<b>Blacksmith:</b> Sorry pal, but you need more coins for that.';
                    return;
                }
                items[2] = "Sword";
                update_items();
                has_sword = true;
                div.textContent = "You want to go outside.";
                text_div.innerHTML = '<b>Blacksmith:</b> Thanks for the business!';
                below_div.innerHTML = '<button onclick="outside()">Go outside</button>';
            }
            function feed_birds() {
                if (items[1] === "Seeds: 3") {
                    below_div.innerHTML = '<button onclick="clear_blacksmith(), remove_info_text()">Go to the blacksmith</button><br/><button onclick="downstairs(), remove_info_text()">Go to your house</button>';
                    text_div.innerHTML = 'You think of your daughter as you toss your seeds to some birds.';
                    has_fed_birds = true;
                    items[1] = " ";
                    update_items();
                } else {
                    text_div.innerHTML = 'You don\'t have any food to feed the birds.';
                }
            }
        </script>
        <div id="forest"></div>
        <script type="text/javascript">
            var has_found_axe = false;
            var has_made_camp = false;
            var has_slept = false;
            var has_boat = false;
            var has_slain_vampire = false;
            function forest_start() {
                below_div.innerHTML = '<button onclick="outside(), remove_info_text()">Go to the village</button><br/>';
                div.textContent = "You feel slightly inspired by the clearing\'s light";
                if (!has_found_axe) {
                    below_div += '<button onclick="find_axe(), remove_info_text()>Search the clearing</button>';
                    text_div.innerHTML = 'You find a small clearing in the woods.';
                } else if (has_found_axe && !has_made_camp) {
                    below_div.innerHTML += '<button onclick="fight_wraiths(), remove_info_text()">Move on</button>';
                } else {
                    below_div.innerHTML += '<button onclick="camp(), remove_info_text()>Go to your camp</button>';
                }
            }
            function find_axe() {
                text_div.innerHTML = 'You find a small axe in a tree stump.';
                items[3] = "Small Axe";
                update_items();
                forest_start();
            }
            function fight_wraiths() {
                div.textContent = "You are mildly frightened.";
                below_div.innerHTML = '<button onclick="wraith_finish()">Fight the wraiths</button>';
                text_div.innerHTML = 'You find four wraiths!';
            }
            function wraith_finish() {
                div.textContent = "You miss your daughter.";
                below_div.innerHTML = '<button onclick="make_camp()">Make camp</button>';
                text_div.innerHTML = 'You need to make camp for the night.';
            }
            function make_camp() {
                text_div.innerHTML = 'You gather leaves chop some fallen logs for a fire.';
                window.setTimeout(find_flint(), 3000);
            }
            function find_flint() {
                text_div.innerHTML += '<br/>You find some flint and rocks nearby.';
                window.setTimeout(make_fire(), 3000);
            }
            function make_fire() {
                text_div.innerHTML += '<br/>You make a small fire and a leaf bed.';
                window.setTimeout(camp(), 3000)
            }
            function camp() {
                remove_info_text();
                div.textContent = "You\'re sentimental as you sit next to the fire.";
                below_div.innerHTML = '<button onclick="outside(), remove_info_text()">Go to the village</button><br/>';
                update_below_div();
            }
            function update_below_div() {
                if (!(items[4] === "Rocks: 30" && items[5] === "Berries: 20")) {
                    below_div.innerHTML += '<button onclick="search_forest(), remove_info_text()">Search the forest</button><br/>';
                }
                if (!(items[6] === "Wood: 15")) {
                    below_div.innerHTML += '<button onclick="chop_wood(), remove_info_text()">Chop some wood</button><br/>';
                }
                if (items[6].length === 7) {
                    if (parseInt(items[6].substring(6, 7)) <= 3) {
                        below_div.innerHTML += '<button onclick="stoke_fire(), remove_info_text()">Stoke the fire</button><br/>';
                    }
                } else {
                    below_div.innerHTML += '<button onclick="stoke_fire(), remove_info_text()">Stoke the fire</button><br/>';
                }
                if (!has_boat) {
                    below_div.innerHTML += '<button onclick="find_river(), remove_info_text()">Explore</button><br/>';
                } else {
                    below_div.innerHTML += '<button onclick="cross_river(), remove_info_text()">Cross the river</button><br/>';
                }
                if (!has_slept) {
                    below_div.innerHTML += '<button onclick="sleep(), remove_info_text()">Go to sleep</button><br/>';
                }
            }
            function stoke_fire() {
                div.textContent = "You wonder if you will ever see your daughter again.";
                text_div.innerHTML = 'You add some wood and stoke the fire.<br/>You watch the flames intently.';
                var amount;
                if (items[6].length === 7) {
                    amount = parseInt(items[6].substring(6, 7));
                } else {
                    amount = parseInt(items[6].substring(6, 8));
                }
                if (items[6] === "Wood: 0") {
                    items[6] = " ";
                } else {
                    items[6] = "Wood: " + amount - 3;
                }
                update_items();
                update_below_div();
            }
            function search_forest() {
                var rocks = false;
                var berries = false;
                if (!(items[4] === "Rocks: 30")) {
                    find_rocks();
                }
                if (!(items[5] === "Berries: 20")) {
                    find_berries();
                }
                if (items[4] === "Rocks: 30" && items[5] === "Berries: 20") {
                    text_div.innerHTML = 'You don\'t find anything.';
                }
                function find_rocks() {
                    rocks = true;
                    text_div.innerHTML = 'You find a few rocks. They might be useful.';
                }
                function find_berries() {
                    berries = true;
                    text_div.innerHTML = 'You search a bush and find some berries. Hope they aren\'t poisonous.';
                }
                if (rocks && berries) {
                    text_div.innerHTML = 'You find some rocks and berries.';
                }
                update_below_div();
            }
            function chop_wood() {
                div.textContent = "The forest is silent; you feel watched.";
                text_div.innerHTML = 'You find a fallen tree and start cutting the trunk.';
                var amount;
                if (items[6].length === 7) {
                    amount = parseInt(items[6].substring(6, 7));
                } else {
                    amount = parseInt(items[6].substring(6, 8));
                }
                items[6] = "Wood: " + amount + 3;
                update_items();
                update_below_div();
            }
            function sleep() {
                has_slept = true;
                div.textContent = "You remember how your daughter loved astronomy.";
                text_div.innerHTML = 'You can barely see the moon through the thick leaf canopy.';
            }
            function find_river() {
                div.textContent = "You need to cross the river.";
                below_div.innerHTML = '<button onclick="camp()">Go to the camp</button><br/>';
                text_div.innerHTML = 'You find a wide, gentle river.';
                if (items[6].substring(6, 7) === 1 || items[6].substring(6, 7) <= 3) {
                    below_div.innerHTML += '<button onclick="made_raft()">Make a raft</button>';
                } else {
                    text_div.innerHTML += '<br/>You need more wood to make a raft.';
                }
                function made_raft() {
                    below_div.innerHTML = '<button onclick="camp()">Go to the camp</button><br/><button onclick="cross_river()">Cross the river</button>';
                    text_div.innerHTML = 'You make a sturdy raft.';
                    var amount;
                    if (items[6].length === 7) {
                        amount = parseInt(items[6].substring(6, 7));
                    } else {
                        amount = parseInt(items[6].substring(6, 8));
                    }
                    items[6] = "Wood: " + amount - 3;
                    update_items();
                }
            }
            function cross_river() {
                div.textContent = "You enjoy the cool breeze.";
                below_div.innerHTML = '<button onclick="camp()">Go to the camp</button><br/>';
                if (!has_slain_vampire) {
                    below_div.innerHTML += '<button onclick="find_vampire()">Continue on</button>';
                } else {
                    below_div.innerHTML += '<button onclick="grasslands_start()">Exit the forest</button>';
                }
                text_div.innerHTML = 'You disembark your raft on the far side of the river.';
            }
            function find_vampire() {
                if (items[6].substring(6, 7) === 1 || items[6].substring(6, 7) <= 3) {
                    div.textContent = "You are scared.";
                    below_div.innerHTML = '<button onclick="craft_stakes()">Craft stakes</button>';
                    text_div.innerHTML = 'You spot a vampire sucking the blood of a deer.';
                } else {
                    div.textContent = "You are in a panic.";
                    text_div.innerHTML = 'There is a sharp pain in your back.<br/>As you slowly fall to the ground, you feel teeth sink into your neck.<br/>';
                    window.setTimeout(kill(), 1500);
                    function kill() {
                        text_div.innerHTML += 'Your eyes flutter one final time. You see a vampire kneel next to you.';
                        window.setTimeout(die(camp()), 3750);
                    }
                }
                function craft_stakes() {
                    div.textContent = "You\'re nervous.";
                    below_div.innerHTML = '<button onclick="kill_vampire()">Kill the vampire</button>';
                    text_div.innerHTML = 'You sharpen some wood into a stake with your axe.';
                    var amount;
                    if (items[6].length === 7) {
                        amount = parseInt(items[6].substring(6, 7));
                    } else {
                        amount = parseInt(items[6].substring(6, 8));
                    }
                    items[6] = "Wood: " + amount - 3;
                    items[7] = "Stake";
                    update_items();
                }
            }
            function kill_vampire() {
                div.textContent = "You hate killing.";
                below_div.innerHTML = '<button onclick="grasslands_start()">Exit the forest</button><br/><button onclick="camp()">Cross the river</button>';
                text_div.innerHTML = "You sneak up on the vampire and thrust the stake through its back.<br/>You throw the body into a pit.";
            }
            function into_the_forest() {
                below_div.innerHTML = '<button onclick="camp()">Go to the camp</button><br/><button onclick="grasslands_start()">Exit the forest</button>';
            }
        </script>
        <div id="grasslands"></div>
        <script type="text/javascript">
            var has_lit_fire = false;
            function grasslands_start() {
                div.textContent = "You need to cross the valley.";
                below_div.innerHTML = '<button onclick="into_the_forest(), remove_info_text()">Go to the forest</button>';
            }
        </script>
        <div id="mountains">
            <div id="landslide"></div>
            <div id="wolves"></div>
        </div>
        <script type="text/javascript">
            function mountains_start() {

            }
        </script>
        <div id="peaks">
            <div id="snowstorm"></div>
        </div>
        <script type="text/javascript">
            function snowstorm_start() {

            }
        </script>
        <div id="castle">
            <div id="entrance"></div>
            <div id="dungeon"></div>
            <div id="tower"></div>
        </div>
        <script type="text/javascript">
            function castle_start() {
                
            }
        </script>
        <div id="boss">
            <div id="bandit_leader"></div>
            <div id="alpha_male"></div>
            <div id="dragon"></div>
            <div id="witch"></div>
        </div>
    </body>
</html>
